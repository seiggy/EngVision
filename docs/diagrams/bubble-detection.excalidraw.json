{
  "type": "excalidraw",
  "version": 2,
  "source": "https://excalidraw.com",
  "elements": [
    {
      "id": "title",
      "type": "text",
      "x": 150,
      "y": 10,
      "width": 400,
      "height": 30,
      "text": "Bubble Detection Pipeline",
      "fontSize": 20,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "input-box",
      "type": "rectangle",
      "x": 250,
      "y": 60,
      "width": 200,
      "height": 50,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "#a5d8ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "input-label", "type": "text" }]
    },
    {
      "id": "input-label",
      "type": "text",
      "x": 290,
      "y": 72,
      "width": 120,
      "height": 25,
      "text": "Page Image (PNG)",
      "fontSize": 14,
      "fontFamily": 1,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "input-box",
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "arrow-input-preprocess",
      "type": "arrow",
      "x": 350,
      "y": 110,
      "width": 0,
      "height": 30,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 30]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "preprocess-box",
      "type": "rectangle",
      "x": 220,
      "y": 140,
      "width": 260,
      "height": 60,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "#b2f2bb",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "preprocess-label", "type": "text" }]
    },
    {
      "id": "preprocess-label",
      "type": "text",
      "x": 240,
      "y": 148,
      "width": 220,
      "height": 46,
      "text": "Preprocessing\nGrayscale → Blur → HSV filter",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "preprocess-box",
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "arrow-preprocess-hough",
      "type": "arrow",
      "x": 350,
      "y": 200,
      "width": 0,
      "height": 30,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 30]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "hough-box",
      "type": "rectangle",
      "x": 180,
      "y": 230,
      "width": 340,
      "height": 80,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "#d0bfff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "hough-label", "type": "text" }]
    },
    {
      "id": "hough-label",
      "type": "text",
      "x": 200,
      "y": 238,
      "width": 300,
      "height": 64,
      "text": "Multi-Pass HoughCircles\nPass 1: param2=50 (strict)\nPass 2: param2=40 (medium)\nPass 3: param2=30 (relaxed)",
      "fontSize": 12,
      "fontFamily": 1,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "hough-box",
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "arrow-hough-verify",
      "type": "arrow",
      "x": 350,
      "y": 310,
      "width": 0,
      "height": 30,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 30]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "verify-title",
      "type": "text",
      "x": 260,
      "y": 345,
      "width": 180,
      "height": 25,
      "text": "Verification Gates",
      "fontSize": 16,
      "fontFamily": 1,
      "textAlign": "center",
      "strokeColor": "#e03131",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "gate1-box",
      "type": "rectangle",
      "x": 40,
      "y": 380,
      "width": 150,
      "height": 60,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "gate1-label", "type": "text" }]
    },
    {
      "id": "gate1-label",
      "type": "text",
      "x": 50,
      "y": 388,
      "width": 130,
      "height": 44,
      "text": "Gate 1: Circularity\nContour area vs\nπr² ratio > 0.60",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "gate1-box",
      "strokeColor": "#e03131",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "gate2-box",
      "type": "rectangle",
      "x": 210,
      "y": 380,
      "width": 150,
      "height": 60,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "gate2-label", "type": "text" }]
    },
    {
      "id": "gate2-label",
      "type": "text",
      "x": 220,
      "y": 388,
      "width": 130,
      "height": 44,
      "text": "Gate 2: Edge Density\nCanny edges in ring\nratio > 0.08",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "gate2-box",
      "strokeColor": "#e03131",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "gate3-box",
      "type": "rectangle",
      "x": 380,
      "y": 380,
      "width": 150,
      "height": 60,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "gate3-label", "type": "text" }]
    },
    {
      "id": "gate3-label",
      "type": "text",
      "x": 390,
      "y": 388,
      "width": 130,
      "height": 44,
      "text": "Gate 3: Interior\nBlank interior check\nwhite ratio > 0.65",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "gate3-box",
      "strokeColor": "#e03131",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "gate4-box",
      "type": "rectangle",
      "x": 550,
      "y": 380,
      "width": 150,
      "height": 60,
      "strokeColor": "#e03131",
      "backgroundColor": "#ffc9c9",
      "fillStyle": "solid",
      "strokeWidth": 1,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "gate4-label", "type": "text" }]
    },
    {
      "id": "gate4-label",
      "type": "text",
      "x": 560,
      "y": 388,
      "width": 130,
      "height": 44,
      "text": "Gate 4: Contrast\nBorder vs interior\ndifference > 30",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "gate4-box",
      "strokeColor": "#e03131",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "arrow-gates-score",
      "type": "arrow",
      "x": 350,
      "y": 440,
      "width": 0,
      "height": 30,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 30]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "score-box",
      "type": "rectangle",
      "x": 220,
      "y": 470,
      "width": 260,
      "height": 60,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "#ffec99",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "score-label", "type": "text" }]
    },
    {
      "id": "score-label",
      "type": "text",
      "x": 240,
      "y": 478,
      "width": 220,
      "height": 44,
      "text": "Scoring & Deduplication\nWeighted: circularity×0.3 + edge×0.25\n+ interior×0.25 + contrast×0.2",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "score-box",
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "arrow-score-leader",
      "type": "arrow",
      "x": 350,
      "y": 530,
      "width": 0,
      "height": 30,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 30]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "leader-box",
      "type": "rectangle",
      "x": 220,
      "y": 560,
      "width": 260,
      "height": 60,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "#eebefa",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "leader-label", "type": "text" }]
    },
    {
      "id": "leader-label",
      "type": "text",
      "x": 240,
      "y": 568,
      "width": 220,
      "height": 44,
      "text": "Leader Line Tracing\nRadial scan from bubble edge\n→ follow line to target region",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "leader-box",
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "arrow-leader-output",
      "type": "arrow",
      "x": 350,
      "y": 620,
      "width": 0,
      "height": 30,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "points": [[0, 0], [0, 30]],
      "startArrowhead": null,
      "endArrowhead": "arrow"
    },
    {
      "id": "output-box",
      "type": "rectangle",
      "x": 220,
      "y": 650,
      "width": 260,
      "height": 60,
      "strokeColor": "#1e1e1e",
      "backgroundColor": "#a5d8ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "output-label", "type": "text" }]
    },
    {
      "id": "output-label",
      "type": "text",
      "x": 240,
      "y": 658,
      "width": 220,
      "height": 44,
      "text": "Output: DetectedRegion[]\nbubble center, radius, number,\nleader line endpoint, confidence",
      "fontSize": 10,
      "fontFamily": 1,
      "textAlign": "center",
      "verticalAlign": "middle",
      "containerId": "output-box",
      "strokeColor": "#1e1e1e",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    },
    {
      "id": "note-text",
      "type": "text",
      "x": 40,
      "y": 730,
      "width": 620,
      "height": 50,
      "text": "Each candidate must pass ALL 4 gates to be kept. Score determines which\ncandidate survives when two overlap (IoU > threshold → keep higher score).\nSee docs/bubble-detection.md for full algorithm details.",
      "fontSize": 11,
      "fontFamily": 1,
      "textAlign": "left",
      "strokeColor": "#868e96",
      "backgroundColor": "transparent",
      "fillStyle": "solid",
      "strokeWidth": 1
    }
  ],
  "appState": {
    "gridSize": null,
    "viewBackgroundColor": "#ffffff"
  },
  "files": {}
}
